(()=>{"use strict";class e{constructor(e){this._form=e,this._modalCallback=document.querySelector(".modal-callback"),this._modalOverlay=document.querySelector(".modal-overlay")}set display(e){this._modalCallback.style.display=e,this._modalOverlay.style.display=e}resetForm(){this._form.reset(),this._form.querySelectorAll("input").forEach((e=>{e.classList.remove("error")}))}}(()=>{const e=document.querySelector("body"),t=document.querySelector(".header-wrapper"),r=document.getElementById("services"),c=document.querySelector(".up"),o=()=>{const e=t.clientHeight,o=r.getBoundingClientRect().top;c.style.display=o<e?"block":"none"};o(),document.addEventListener("scroll",(()=>{o()})),c.addEventListener("click",(()=>{e.scrollIntoView({behavior:"smooth",block:"start"})}))})(),(()=>{const e=document.querySelector(".accordeon");e.addEventListener("click",(t=>{const r=t.target.closest(".element:not(.active)");r&&([...e.querySelectorAll(".element")].map((e=>{e.classList.remove("active"),e.querySelector(".element-content").style.display="none"})),r.classList.add("active"),r.querySelector(".element-content").style.display="block")}))})(),(()=>{const e=[...document.querySelector(".top-slider").querySelectorAll(".item")],t=document.querySelector(".top-slider__dots"),r=[...t.querySelectorAll(".top-slider__dots-item")],c={timeout:3e3,active:0};let o;const s=(e=c.active)=>{c.active=e,l(),a()},l=()=>{let t=!1;e.map(((o,s)=>{c.active!==s||t?(o.classList.remove("active"),r[s].classList.remove("active")):(t=!0,o.classList.add("active"),r[s].classList.add("active"),s<e.length-1?c.active=c.active+1:c.active=0)}))},a=()=>{o=setInterval((()=>{l()}),c.timeout)};s(),t.addEventListener("click",(e=>{const t=e.target.closest(".top-slider__dots-item");if(t){const e=t.getAttribute("data-index");clearInterval(o),s(+e)}}))})(),(()=>{const t=document.querySelector("body"),r=document.querySelector('form[name="form-callback"]'),c=new e(r);t.addEventListener("click",(e=>{(e.target.classList.contains("callback-btn")||e.target.classList.contains("button-services")||e.target.classList.contains("fancyboxModal"))&&(c.display="block"),(e.target.closest(".modal-close")||e.target.closest(".modal-overlay"))&&(c.display="none",c.resetForm())}))})(),(()=>{const e=[...document.querySelectorAll(".services-carousel > div")],t=document.querySelector(".services-arrow"),r=t.querySelector(".arrow-left"),c=t.querySelector(".arrow-right");let o=0;const s=()=>{const e=document.documentElement.clientWidth;return e<768?1:e<992?2:3},l=()=>{const t=s();e.map(((e,r)=>{e.style.display=o+t>r&&r>=o?"block":"none"})),r.style.opacity=0===o?".3":"1",o+s()===e.length?c.style.opacity=".3":c.style.opacity="1"};l(),t.addEventListener("click",(t=>{t.target.classList.contains("arrow-left")&&(t.target,o>0&&(o--,l())),t.target.classList.contains("arrow-right")&&(t.target,o<e.length-s()&&(o++,l()))})),window.addEventListener("resize",(()=>{l()}))})(),(()=>{const t=document.querySelector("input.feedback"),r=document.querySelector('form[name="form-callback"]'),c=r.querySelectorAll("input"),o=/[^а-яА-Я]/gi,s=/[^\d+]/gi,l=new e(r);let a;const n=(e,r="")=>{const c=document.querySelector(".js-message-block"),o=document.createElement("div");switch(clearTimeout(a),o.classList.add("js-message-block"),o.textContent=e,o.style.textAlign="center",o.style.margin="20px 0 0 0",r){case"error":o.style.color="red";break;case"success":o.style.color="green";break;default:o.style.color="grey"}c&&c.remove(),t.insertAdjacentElement("afterend",o),(()=>{const e=document.querySelector(".js-message-block");a=setTimeout((()=>{e&&e.remove()}),3e3)})()};t.addEventListener("click",(e=>{if(n("Загрузка, ожидайте..."),e.preventDefault(),(e=>{let t=!0;return e.forEach((e=>{const r=e.getAttribute("name");e.classList.remove("error"),"tel"===r&&(s.test(e.value.trim())||e.value.trim().length<1)&&(t=!1,e.classList.add("error"),n("Ошибка =(","error"))})),t})(c)){const e={};e.phone=r.querySelector('[name="tel"]').value,r.querySelector('[name="fio"]').value.length>0&&(e.name=r.querySelector('[name="fio"]').value),((e,t)=>{fetch("./server.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((e=>{if(!e.ok)throw Error(`Сервер временно недоступен: ${e.status}`);return e.json()})).then((e=>{l.resetForm(),n("Спасибо! Данные отправлены!","success")})).catch((e=>{n(e.message,"error"),l.resetForm()}))})(0,e)}})),c.forEach((e=>{e.addEventListener("input",(e=>{e.currentTarget.classList.remove("error"),"fio"===e.currentTarget.getAttribute("name")&&(e.currentTarget.value=e.currentTarget.value.replace(o,"")),"tel"===e.currentTarget.getAttribute("name")&&(e.currentTarget.value=e.currentTarget.value.replace(s,""))}))}))})()})();